// dashboard.js

document.addEventListener('DOMContentLoaded', function() {
    const div = document.getElementById("dataContainer");
    let addRecord=(data) =>{

        console.log(data)
        function formatDate(dateString) {
            const options = {
              day: 'numeric',
              month: 'long',
              year: 'numeric',
              hour: 'numeric',
              minute: 'numeric',
              hour12: true
            };
            
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', options);
        }
          
          // Example usage:
          const originalDate = data.date;
          const formattedDate = formatDate(originalDate);
          // console.log(formattedDate)
        const infoEl=document.getElementById("infoId")
        // console.log(infoEl)

        var trEl = document.createElement("TR");
        // trEl.setAttribute("id", "myTr");

        var y = document.createElement("TD");
        // y.setAttribute("id", "myTr");
    
        const productDetailsEl=document.createElement("div");
        productDetailsEl.setAttribute('style', 'width: 200px;');
        const userNameEl=document.createElement("p");
        const scanTimeEl=document.createElement("p");
        scanTimeEl.setAttribute('style', 'width: 170px;');
        const LocationEl=document.createElement("p");
        LocationEl.setAttribute('style', 'width: 170px;');
        const UserIdEl=document.createElement("p");
        const AppEl=document.createElement("p");
        const ResultEl=document.createElement("p");
        
        // productDetailsEl.textContent="product name:Horlicks serial No:1234 commisioned :12th july"
        
        const productNameEl = document.createElement("p")
        const serialNoEl = document.createElement("p")
        const productgtinEl = document.createElement("p")

        
        
        
        // console.log(data)
        productNameEl.textContent="Name:"+data.product_name
        serialNoEl.textContent="S.No:"+data.serial_no
        productgtinEl.textContent="Batch No:"+data.batch_code
        userNameEl.textContent="XXXXXX";
        scanTimeEl.textContent=formattedDate;
        LocationEl.textContent=`latitude:${data.latitude}, longitude:${data.longitude}`;
        UserIdEl.textContent=data.duration;
        AppEl.textContent=data.app;
        ResultEl.textContent=data.result;
        
        productDetailsEl.appendChild(productNameEl)
        productDetailsEl.appendChild(serialNoEl)
        productDetailsEl.appendChild(productgtinEl)
        y.appendChild(productDetailsEl)//,userNameEl,scanTimeEl,LocationEl,UserIdEl,AppEl,ResultEl
        y.appendChild(userNameEl)
        y.appendChild(scanTimeEl)
        y.appendChild(LocationEl)
        y.appendChild(UserIdEl)
        y.appendChild(AppEl)
        y.appendChild(ResultEl)
        y.classList.add('row-container')
        y.setAttribute('style','background-color:#fff0b3')
        productDetailsEl.classList.add("data")
        userNameEl.classList.add('data')
        scanTimeEl.classList.add('data')
        LocationEl.classList.add('data')
        UserIdEl.classList.add('data')
        AppEl.classList.add('data')
        ResultEl.classList.add('data')

        trEl.appendChild(y)
        infoEl.append(trEl)
    }
    
 
    let url = "http://localhost:3030/products";
    let options = {
      method: "GET"
    };

    fetch(url, options)
        .then(response => response.json())
        .then(data => display(data))
        .catch(error => console.error('Error:', error));
    
    let display = (data)=>{
        data.forEach(record => {
                addRecord(record)
            });
    }
    
    
  });
